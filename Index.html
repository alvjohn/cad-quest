<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD Dictionary Quest | Jacey Kate Lee</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel for standalone execution -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0;
            padding: 0;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        
        /* Loading Screen */
        #loading-screen {
            position: fixed;
            inset: 0;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <!-- Initial Loading State -->
    <div id="loading-screen">
        <div class="w-12 h-12 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin mb-4"></div>
        <p class="text-slate-500 font-bold uppercase tracking-widest text-xs">Loading CAD Quest...</p>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const dictionaryData = {
            "2D Concepts": {
                icon: "layout",
                items: [
                    { name: "2D Modeling", def: "Creating flat drawings using only length and width (no depth).", purpose: "Used for floor plans, schematics, and technical drawings.", example: "Drawing a house floor plan from a top view." },
                    { name: "CAD", def: "Computer-Aided Design. The use of computer software to create, modify, and analyze designs.", purpose: "To make drafting faster, more accurate, and easier to edit.", example: "Using CAD to design machine parts." },
                    { name: "SOLIDWORKS", def: "A CAD software mainly used for 3D modeling and engineering designs.", purpose: "To design mechanical parts and assemblies.", example: "Creating a 3D model of a gear." },
                    { name: "AutoCAD", def: "A CAD software widely used for 2D drafting and basic 3D design.", purpose: "To create precise technical drawings.", example: "Drafting electrical or architectural plans." },
                    { name: "SketchUp", def: "A CAD software known for easy 3D modeling.", purpose: "To quickly visualize designs in 3D.", example: "Creating a 3D model of a building." },
                    { name: "Interface", def: "The visual layout of menus, icons, and tools in a software.", purpose: "To allow users to interact with the program.", example: "Toolbars and command menus in AutoCAD." },
                    { name: "Workspace", def: "The area where drawings are created and edited.", purpose: "To provide a space for designing.", example: "The blank drawing area in CAD." },
                    { name: "Tool Palette", def: "A panel that contains commonly used tools and commands.", purpose: "To access tools quickly.", example: "A palette with drawing and editing tools." }
                ]
            },
            "Drawing Tools": {
                icon: "mouse-pointer-2",
                items: [
                    { name: "Line", def: "A straight line between two points.", purpose: "To create edges and outlines.", example: "Wall boundaries." },
                    { name: "Circle", def: "A round shape defined by a center and radius.", purpose: "To draw holes or round objects.", example: "Pipe cross-sections." },
                    { name: "Arc", def: "A curved line that is part of a circle.", purpose: "To create curved shapes.", example: "Door swings." },
                    { name: "Ellipse", def: "An oval-shaped curve.", purpose: "To draw oval objects.", example: "Table tops." },
                    { name: "Rectangle", def: "A four-sided shape with right angles.", purpose: "To draw boxes or rooms.", example: "Furniture blocks." },
                    { name: "Polygon", def: "A shape with multiple straight sides.", purpose: "To create geometric figures.", example: "Hexagonal nuts." },
                    { name: "Polyline", def: "A connected series of lines and arcs treated as one object.", purpose: "To create continuous shapes.", example: "Property lines." },
                    { name: "Spline", def: "A smooth, flexible curve.", purpose: "To draw free-form shapes.", example: "Topographic lines." },
                    { name: "Points", def: "A single location in space.", purpose: "To mark exact positions.", example: "Reference nodes." },
                    { name: "Revision Cloud", def: "A cloud-shaped outline.", purpose: "To highlight drawing changes.", example: "Marking a modified wall." },
                    { name: "Construction Line", def: "A guide line used for reference.", purpose: "To help align objects.", example: "Grid layout lines." },
                    { name: "Array", def: "A repeated pattern of objects.", purpose: "To duplicate objects evenly.", example: "Rows of chairs." }
                ]
            },
            "Modification": {
                icon: "settings-2",
                items: [
                    { name: "Move", def: "Changes an object's position.", purpose: "To relocate objects.", example: "Moving a door symbol." },
                    { name: "Copy", def: "Creates a duplicate object.", purpose: "To save time.", example: "Copying windows." },
                    { name: "Rotate", def: "Turns an object around a point.", purpose: "To change orientation.", example: "Rotating a chair symbol." },
                    { name: "Offset", def: "Creates a parallel copy.", purpose: "To show thickness.", example: "Offsetting walls." },
                    { name: "Mirror", def: "Flips objects symmetrically.", purpose: "To create identical opposite parts.", example: "Mirroring windows." },
                    { name: "Scale", def: "Changes size proportionally.", purpose: "To resize objects.", example: "Scaling a logo." },
                    { name: "Trim", def: "Cuts excess parts.", purpose: "To clean drawings.", example: "Trimming overlapping lines." },
                    { name: "Extend", def: "Lengthens an object.", purpose: "To meet boundaries.", example: "Extending a wall." },
                    { name: "Erase", def: "Deletes objects.", purpose: "To remove errors.", example: "Deleting extra lines." },
                    { name: "Explode", def: "Breaks objects into parts.", purpose: "To edit individual elements.", example: "Exploding a block." },
                    { name: "Overkill", def: "Removes duplicate lines.", purpose: "To clean drawings.", example: "Fixing overlapping lines." },
                    { name: "Stretch", def: "Changes parts of an object's shape.", purpose: "To adjust dimensions.", example: "Stretching a room size." },
                    { name: "Break", def: "Splits an object.", purpose: "To create gaps.", example: "Breaking a line for a door." },
                    { name: "Join", def: "Connects objects.", purpose: "To form a single object.", example: "Joining lines into a polyline." },
                    { name: "Fillet", def: "Rounds a corner.", purpose: "To smooth edges.", example: "Rounding table corners." },
                    { name: "Chamfer", def: "Bevels a corner.", purpose: "To create angled edges.", example: "Cutting sharp corners." },
                    { name: "Lengthen", def: "Adjust an object's length.", purpose: "To control dimensions.", example: "Lengthening a line." },
                    { name: "Reverse", def: "Changes object direction.", purpose: "To fix orientation.", example: "Reversing a polyline direction." }
                ]
            },
            "Status & Arrays": {
                icon: "layers",
                items: [
                    { name: "Grid", def: "Background reference lines.", purpose: "To guide drawings.", example: "Aligning objects." },
                    { name: "Snap", def: "Lock movement to intervals.", purpose: "For precision.", example: "Snapping to grid points." },
                    { name: "Polar", def: "Guides angles.", purpose: "To draw at set angles.", example: "Drawing 45 degree lines." },
                    { name: "Ortho", def: "Restricts movement to 90 degrees.", purpose: "For straight lines.", example: "Drawing vertical walls." },
                    { name: "Dynamic Input", def: "Shows commands near cursor.", purpose: "To work faster.", example: "Typing dimensions beside cursor." },
                    { name: "Polar Path", def: "Objects arranged in a circular pattern.", purpose: "To create radial designs.", example: "Bolts around a wheel." },
                    { name: "Rectangular Path", def: "Objects arranged in rows and columns.", purpose: "To create grids.", example: "Chairs in a classroom." }
                ]
            }
        };

        const apiKey = "";
        const GEMINI_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        async function callGemini(userPrompt, systemPrompt = "You are a helpful CAD expert.") {
            if (!apiKey) {
                return "The ✨ AI Assistant is ready but needs an API key to think. Please ask Jacey to provide one!";
            }
            
            const payload = {
                contents: [{ parts: [{ text: userPrompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            const maxRetries = 5;
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(GEMINI_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('API request failed');
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "No response found.";
                } catch (err) {
                    if (i === maxRetries - 1) throw err;
                    await new Promise(res => setTimeout(res, Math.pow(2, i) * 1000));
                }
            }
        }

        const Icon = ({ name, className }) => {
            const ref = useRef(null);
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        function App() {
            const [activeSection, setActiveSection] = useState("2D Concepts");
            const [isSidebarOpen, setSidebarOpen] = useState(true);
            const [searchQuery, setSearchQuery] = useState("");
            const [aiScenarios, setAiScenarios] = useState({});
            const [loadingScenarios, setLoadingScenarios] = useState({});
            const [showChat, setShowChat] = useState(false);
            const [chatInput, setChatInput] = useState("");
            const [chatHistory, setChatHistory] = useState([
                { role: 'ai', text: "Hi Jacey! I'm your ✨ AI CAD Tutor. Ask me anything about these dictionary terms!" }
            ]);
            const [chatLoading, setChatLoading] = useState(false);
            const chatEndRef = useRef(null);

            useEffect(() => {
                // Remove loading screen when React is ready
                const loader = document.getElementById('loading-screen');
                if (loader) {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.remove(), 500);
                }
            }, []);

            useEffect(() => {
                chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [chatHistory]);

            const filteredItems = dictionaryData[activeSection].items.filter(item => 
                item.name.toLowerCase().includes(searchQuery.toLowerCase())
            );

            const generateScenario = async (itemName) => {
                setLoadingScenarios(prev => ({ ...prev, [itemName]: true }));
                try {
                    const prompt = `Explain a specific, practical real-world scenario where a designer would use the CAD command/concept "${itemName}". Write it as a short 3-step practical exercise for a student. Keep it concise.`;
                    const result = await callGemini(prompt, "You are a CAD teacher. Provide practical, creative, and technical industry examples.");
                    setAiScenarios(prev => ({ ...prev, [itemName]: result }));
                } catch (err) {
                    setAiScenarios(prev => ({ ...prev, [itemName]: "AI Assistant unavailable at the moment." }));
                } finally {
                    setLoadingScenarios(prev => ({ ...prev, [itemName]: false }));
                }
            };

            const handleChat = async (e) => {
                e.preventDefault();
                if (!chatInput.trim()) return;
                const userMsg = { role: 'user', text: chatInput };
                setChatHistory(prev => [...prev, userMsg]);
                setChatInput("");
                setChatLoading(true);
                try {
                    const response = await callGemini(chatInput, "CAD Tutor for Jacey Kate Lee.");
                    setChatHistory(prev => [...prev, { role: 'ai', text: response }]);
                } catch (err) {
                    setChatHistory(prev => [...prev, { role: 'ai', text: "Error connecting to AI assistant." }]);
                } finally {
                    setChatLoading(false);
                }
            };

            return (
                <div className="flex h-screen overflow-hidden bg-slate-50">
                    <aside className={`${isSidebarOpen ? 'w-64' : 'w-20'} transition-all duration-300 bg-white border-r border-slate-200 flex flex-col shadow-sm z-20`}>
                        <div className="p-6 border-b border-slate-100 flex items-center justify-between">
                            {isSidebarOpen ? (
                                <div className="flex items-center gap-2">
                                    <div className="bg-emerald-600 p-2 rounded-lg text-white shadow-lg shadow-emerald-200 flex items-center justify-center">
                                        <Icon name="file-code" className="w-5 h-5" />
                                    </div>
                                    <span className="font-bold text-lg tracking-tight uppercase">CAD Quest</span>
                                </div>
                            ) : (
                                <div className="mx-auto text-emerald-600"><Icon name="file-code" className="w-6 h-6" /></div>
                            )}
                        </div>

                        <nav className="flex-1 p-4 space-y-2 overflow-y-auto custom-scrollbar">
                            {Object.keys(dictionaryData).map((section) => (
                                <button
                                    key={section}
                                    onClick={() => setActiveSection(section)}
                                    className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all ${
                                        activeSection === section 
                                        ? 'bg-emerald-50 text-emerald-700 font-semibold shadow-sm' 
                                        : 'text-slate-500 hover:bg-slate-50'
                                    }`}
                                >
                                    <Icon name={dictionaryData[section].icon} className="w-5 h-5" />
                                    {isSidebarOpen && <span className="text-sm font-medium">{section}</span>}
                                </button>
                            ))}
                        </nav>
                        <div className="p-4 border-t border-slate-100 text-[10px] text-slate-400 text-center font-bold uppercase tracking-widest">
                            {isSidebarOpen && <span>SPSCIE • Jacey Kate Lee</span>}
                        </div>
                    </aside>

                    <main className="flex-1 flex flex-col overflow-hidden relative">
                        <header className="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-8">
                            <div className="flex items-center gap-4 flex-1 max-w-xl">
                                <button onClick={() => setSidebarOpen(!isSidebarOpen)} className="p-2 hover:bg-slate-100 rounded-lg hidden lg:block transition-colors">
                                    <Icon name="menu" className="w-5 h-5 text-slate-600" />
                                </button>
                                <div className="relative w-full">
                                    <Icon name="search" className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" />
                                    <input 
                                        type="text" 
                                        placeholder={`Search CAD Terms...`}
                                        className="w-full bg-slate-50 border border-slate-200 rounded-full py-2.5 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                    />
                                </div>
                            </div>
                            <div className="flex items-center gap-4 ml-4">
                                <div className="text-right hidden sm:block">
                                    <p className="text-sm font-bold uppercase tracking-tight text-slate-800">JACEY KATE LEE</p>
                                    <p className="text-[10px] text-slate-400 uppercase tracking-widest font-bold">SPSCIE Fe Del Mundo</p>
                                </div>
                                <div className="w-10 h-10 rounded-full bg-emerald-600 border-2 border-white flex items-center justify-center font-bold text-white shadow-md">JKL</div>
                            </div>
                        </header>

                        <div className="flex-1 overflow-y-auto p-8 custom-scrollbar">
                            <div className="max-w-6xl mx-auto">
                                <div className="mb-8 flex items-center justify-between">
                                    <h1 className="text-3xl font-black text-slate-800 tracking-tighter uppercase">{activeSection}</h1>
                                    <div className="flex items-center gap-2 bg-white px-4 py-2 rounded-full border border-emerald-100 shadow-sm">
                                        <Icon name="sparkles" className="w-4 h-4 text-emerald-500" />
                                        <span className="text-[10px] font-bold text-emerald-800 uppercase tracking-widest">AI Assisted</span>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {filteredItems.map((item, idx) => (
                                        <div key={idx} className="bg-white rounded-3xl border border-slate-200 shadow-sm hover:shadow-xl hover:-translate-y-1.5 transition-all duration-300 overflow-hidden flex flex-col group">
                                            <div className="p-6 border-b border-slate-50 bg-gradient-to-br from-white to-slate-50/20">
                                                <h3 className="text-xl font-bold text-slate-800 tracking-tight group-hover:text-emerald-700 transition-colors">{item.name}</h3>
                                            </div>
                                            <div className="p-6 space-y-4 flex-1">
                                                <div className="flex gap-3">
                                                    <Icon name="info" className="w-4 h-4 text-emerald-600 mt-1 flex-shrink-0" />
                                                    <p className="text-slate-600 text-sm leading-relaxed font-medium">{item.def}</p>
                                                </div>
                                                <div className="flex gap-3">
                                                    <Icon name="lightbulb" className="w-4 h-4 text-amber-500 mt-1 flex-shrink-0" />
                                                    <p className="text-slate-600 text-sm leading-relaxed font-medium">{item.purpose}</p>
                                                </div>
                                                <div className="bg-slate-50 rounded-2xl p-4 border border-dashed border-slate-200">
                                                    <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1">Example</span>
                                                    <p className="text-xs italic text-slate-500 font-medium">"{item.example}"</p>
                                                    <div className="mt-4 pt-3 border-t border-slate-200">
                                                        {aiScenarios[item.name] ? (
                                                            <div className="text-[11px] text-emerald-900 bg-emerald-50/50 p-3 rounded-xl border border-emerald-100 font-medium leading-relaxed">
                                                                <span className="font-bold block mb-1 uppercase tracking-tighter text-emerald-700">AI Activity:</span>
                                                                {aiScenarios[item.name]}
                                                            </div>
                                                        ) : (
                                                            <button 
                                                                onClick={() => generateScenario(item.name)}
                                                                disabled={loadingScenarios[item.name]}
                                                                className="text-[10px] font-bold text-emerald-600 hover:text-emerald-800 flex items-center gap-1.5 transition-colors disabled:opacity-50"
                                                            >
                                                                {loadingScenarios[item.name] ? (
                                                                    <><Icon name="loader-2" className="w-3 h-3 animate-spin" /> Analyzing...</>
                                                                ) : (
                                                                    <><Icon name="sparkles" className="w-3 h-3" /> Get AI Scenario</>
                                                                )}
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Floating Chat */}
                        <div className="fixed bottom-8 right-8 z-50 flex flex-col items-end gap-4">
                            {showChat && (
                                <div className="bg-white rounded-[2rem] shadow-2xl border border-slate-200 flex flex-col h-[500px] w-80 sm:w-96 overflow-hidden animate-in slide-in-from-bottom-10 duration-300">
                                    <div className="bg-emerald-600 p-5 flex items-center justify-between text-white">
                                        <div className="flex items-center gap-3">
                                            <Icon name="sparkles" className="w-5 h-5" />
                                            <div>
                                                <h4 className="font-bold text-sm">✨ CAD AI Tutor</h4>
                                                <p className="text-[9px] font-bold opacity-75 uppercase">Jacey's Assistant</p>
                                            </div>
                                        </div>
                                        <button onClick={() => setShowChat(false)} className="hover:bg-white/20 p-2 rounded-xl transition-colors"><Icon name="x" className="w-5 h-5" /></button>
                                    </div>
                                    <div className="flex-1 overflow-y-auto p-5 space-y-4 bg-slate-50 custom-scrollbar">
                                        {chatHistory.map((msg, i) => (
                                            <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                <div className={`p-4 rounded-3xl text-sm leading-relaxed shadow-sm max-w-[85%] ${msg.role === 'user' ? 'bg-emerald-600 text-white rounded-br-none' : 'bg-white border border-slate-200 text-slate-700 rounded-bl-none'}`}>
                                                    {msg.text}
                                                </div>
                                            </div>
                                        ))}
                                        {chatLoading && (
                                            <div className="flex justify-start">
                                                <div className="p-4 rounded-3xl bg-white border border-slate-200 rounded-bl-none shadow-sm">
                                                    <Icon name="loader-2" className="w-4 h-4 animate-spin text-emerald-600" />
                                                </div>
                                            </div>
                                        )}
                                        <div ref={chatEndRef} />
                                    </div>
                                    <form onSubmit={handleChat} className="p-4 border-t bg-white flex gap-2">
                                        <input 
                                            value={chatInput} 
                                            onChange={e => setChatInput(e.target.value)} 
                                            className="flex-1 bg-slate-100 rounded-2xl px-5 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 font-medium" 
                                            placeholder="Ask a CAD question..." 
                                        />
                                        <button className="bg-emerald-600 text-white p-2.5 rounded-2xl hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-200"><Icon name="send" className="w-4 h-4" /></button>
                                    </form>
                                </div>
                            )}
                            <button 
                                onClick={() => setShowChat(!showChat)} 
                                className={`p-4 rounded-full shadow-2xl hover:scale-110 active:scale-95 transition-all flex items-center gap-2 ${showChat ? 'bg-slate-800' : 'bg-emerald-600'} text-white group`}
                            >
                                <Icon name={showChat ? "x" : "message-circle"} className="w-6 h-6" />
                                {!showChat && <span className="text-xs font-bold uppercase tracking-widest pr-2 hidden sm:inline">Ask AI</span>}
                            </button>
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>